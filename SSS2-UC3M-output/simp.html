<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Lab notes for Statistics for Social Sciences II: Multivariate Techniques</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="Lab notes for <em>Statistics for Social Sciences II: Multivariate Techniques</em>">
  <meta name="generator" content="bookdown 0.1.6 and GitBook 2.6.7">

  <meta property="og:title" content="Lab notes for Statistics for Social Sciences II: Multivariate Techniques" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Lab notes for <em>Statistics for Social Sciences II: Multivariate Techniques</em>" />
  <meta name="github-repo" content="egarpor/SSS2-UC3M" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Lab notes for Statistics for Social Sciences II: Multivariate Techniques" />
  
  <meta name="twitter:description" content="Lab notes for <em>Statistics for Social Sciences II: Multivariate Techniques</em>" />
  

<meta name="author" content="Eduardo García Portugués">

<meta name="date" content="2016-09-07">

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="index.html">


<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Statistics for Social Sciences II: Multivariate Techniques</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#some-course-logistics"><i class="fa fa-check"></i>Some course logistics</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#software-required"><i class="fa fa-check"></i>Software required</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-this-software"><i class="fa fa-check"></i>Why this software?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#installation-in-your-own-laptop"><i class="fa fa-check"></i>Installation in your own laptop</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="simp.html"><a href="simp.html"><i class="fa fa-check"></i><b>1</b> Simple linear regression</a><ul>
<li class="chapter" data-level="1.1" data-path="simp.html"><a href="simp.html#motivation-model-formulation-examples-applications-assumptions"><i class="fa fa-check"></i><b>1.1</b> Motivation; model formulation; examples; applications; assumptions</a><ul>
<li class="chapter" data-level="1.1.1" data-path="simp.html"><a href="simp.html#motivating-example"><i class="fa fa-check"></i><b>1.1.1</b> Motivating example</a></li>
<li class="chapter" data-level="1.1.2" data-path="simp.html"><a href="simp.html#the-lm-function"><i class="fa fa-check"></i><b>1.1.2</b> The <code>lm</code> function</a></li>
<li class="chapter" data-level="1.1.3" data-path="simp.html"><a href="simp.html#the-least-squares-estimate"><i class="fa fa-check"></i><b>1.1.3</b> The least squares estimate</a></li>
<li class="chapter" data-level="1.1.4" data-path="simp.html"><a href="simp.html#summary-of-the-model"><i class="fa fa-check"></i><b>1.1.4</b> Summary of the model</a></li>
<li class="chapter" data-level="1.1.5" data-path="simp.html"><a href="simp.html#prediction"><i class="fa fa-check"></i><b>1.1.5</b> Prediction</a></li>
<li class="chapter" data-level="1.1.6" data-path="simp.html"><a href="simp.html#some-words-of-caution-with-r2"><i class="fa fa-check"></i><b>1.1.6</b> Some words of caution with <span class="math inline">\(R^2\)</span></a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="simp.html"><a href="simp.html#estimation-of-model-parameters-least-squares-inference-for-model-parameters-forecasting."><i class="fa fa-check"></i><b>1.2</b> Estimation of model parameters; least squares; inference for model parameters; forecasting.</a></li>
<li class="chapter" data-level="1.3" data-path="simp.html"><a href="simp.html#assessing-model-fit-anova-model-validation-model-diagnostics-handling-nonlinear-relationships."><i class="fa fa-check"></i><b>1.3</b> Assessing model fit; ANOVA; model validation; model diagnostics; handling nonlinear relationships.</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/egarpor/SSS2-UC3M" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Lab notes for <em>Statistics for Social Sciences II: Multivariate Techniques</em></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simp" class="section level1">
<h1><span class="header-section-number">Chapter 1</span> Simple linear regression</h1>
<div id="motivation-model-formulation-examples-applications-assumptions" class="section level2">
<h2><span class="header-section-number">1.1</span> Motivation; model formulation; examples; applications; assumptions</h2>
<div id="motivating-example" class="section level3">
<h3><span class="header-section-number">1.1.1</span> Motivating example</h3>
<p>Suppose we have a production line where we measured the time (in minutes) required to produce a number of solicited items. There are two random variables: <code>y</code> = “time required to produce an order” and <code>x</code> = “number of items in the order”. We want to explain/predict <code>y</code> from <code>x</code> from a linear model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Production time</span>
y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">175</span>, <span class="dv">189</span>, <span class="dv">344</span>, <span class="dv">88</span>, <span class="dv">114</span>, <span class="dv">338</span>, <span class="dv">271</span>, <span class="dv">173</span>, <span class="dv">284</span>, <span class="dv">277</span>, <span class="dv">337</span>, <span class="dv">58</span>, <span class="dv">146</span>, <span class="dv">277</span>, <span class="dv">123</span>, <span class="dv">227</span>, <span class="dv">63</span>, <span class="dv">337</span>, <span class="dv">146</span>, <span class="dv">68</span>)

<span class="co"># Number of units in the order</span>
x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">195</span>, <span class="dv">215</span>, <span class="dv">243</span>, <span class="dv">162</span>, <span class="dv">185</span>, <span class="dv">231</span>, <span class="dv">234</span>, <span class="dv">166</span>, <span class="dv">253</span>, <span class="dv">196</span>, <span class="dv">220</span>, <span class="dv">168</span>, <span class="dv">207</span>, <span class="dv">225</span>, <span class="dv">169</span>, <span class="dv">215</span>, <span class="dv">147</span>, <span class="dv">230</span>, <span class="dv">208</span>, <span class="dv">172</span>)

<span class="co"># Data scatterplot (pch = 16 for filled points)</span>
<span class="kw">plot</span>(y ~<span class="st"> </span>x, <span class="dt">pch =</span> <span class="dv">16</span>)</code></pre></div>
<p><img src="SSS2-UC3M_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
</div>
<div id="the-lm-function" class="section level3">
<h3><span class="header-section-number">1.1.2</span> The <code>lm</code> function</h3>
<p>The linear fit in <code>R</code> is done by the <code>lm</code> function and the formula <code>y ~ x</code>, used to denote that we are interested in regressing <code>y</code> over <code>x</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Fit a linear model y = beta0 + beta1 * x</span>
reg &lt;-<span class="st"> </span><span class="kw">lm</span>(y ~<span class="st"> </span>x)

<span class="co"># The result is a list with several objects</span>
<span class="kw">names</span>(reg)</code></pre></div>
<pre><code>##  [1] &quot;coefficients&quot;  &quot;residuals&quot;     &quot;effects&quot;       &quot;rank&quot;         
##  [5] &quot;fitted.values&quot; &quot;assign&quot;        &quot;qr&quot;            &quot;df.residual&quot;  
##  [9] &quot;xlevels&quot;       &quot;call&quot;          &quot;terms&quot;         &quot;model&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># The fitted coefficients beta0 (intercept) and beta1 (slope)</span>
reg$coefficients</code></pre></div>
<pre><code>## (Intercept)           x 
## -367.360643    2.816682</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># The regression line with the minimized distances</span>
<span class="kw">plot</span>(y ~<span class="st"> </span>x, <span class="dt">pch =</span> <span class="dv">16</span>)
<span class="kw">abline</span>(reg, <span class="dt">col =</span> <span class="dv">2</span>)
<span class="kw">segments</span>(<span class="dt">x0 =</span> x, <span class="dt">y0 =</span> y, <span class="dt">x1 =</span> x, <span class="dt">y1 =</span> reg$fitted.values)</code></pre></div>
<p><img src="SSS2-UC3M_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
</div>
<div id="the-least-squares-estimate" class="section level3">
<h3><span class="header-section-number">1.1.3</span> The least squares estimate</h3>
<p>We can check and visualize that <code>reg$coefficients</code> indeed contains the least squares estimates and that they minimize the Residual Sum of Squares (RSS).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create the design matrix</span>
X &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="dv">1</span>, x)

<span class="co"># The analytical solution</span>
betahat &lt;-<span class="st"> </span><span class="kw">solve</span>(<span class="kw">t</span>(X) %*%<span class="st"> </span>X) %*%<span class="st"> </span><span class="kw">t</span>(X) %*%<span class="st"> </span>y
betahat</code></pre></div>
<pre><code>##          [,1]
##   -367.360643
## x    2.816682</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Minimal RSS</span>
<span class="kw">sum</span>((y -<span class="st"> </span>X %*%<span class="st"> </span>betahat)^<span class="dv">2</span>)</code></pre></div>
<pre><code>## [1] 51658.57</code></pre>
<p>You can try to get a better RSS. Good luck! :)</p>
</div>
<div id="summary-of-the-model" class="section level3">
<h3><span class="header-section-number">1.1.4</span> Summary of the model</h3>
<p>The <code>summary</code> function applied to a <code>lm</code> object gives the fitted coefficients and its significances (“Pr(&gt;|t|)”), the <span class="math inline">\(R^2\)</span> (“Multiple R-squared”) and the fitted error variance (“Residual standard error”).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Summary of the fit</span>
<span class="kw">summary</span>(reg)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -72.509 -48.159  -3.917  33.857  92.291 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -367.3606    82.4122  -4.458 0.000304 ***
## x              2.8167     0.4035   6.980 1.61e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 53.57 on 18 degrees of freedom
## Multiple R-squared:  0.7302, Adjusted R-squared:  0.7152 
## F-statistic: 48.72 on 1 and 18 DF,  p-value: 1.615e-06</code></pre>
</div>
<div id="prediction" class="section level3">
<h3><span class="header-section-number">1.1.5</span> Prediction</h3>
<p>Prediction of a new observation can be done via the function <code>predict</code>, which also provides conficence intervals. The <code>newdata</code> argument of <code>predict</code> needs a <code>data.frame</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Point in which we want a prediction for y</span>
newx &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="dv">200</span>)

<span class="co"># Prediction with 95% confidence interval</span>
<span class="kw">predict</span>(reg, <span class="dt">newdata =</span> newx, <span class="dt">interval =</span> <span class="st">&quot;prediction&quot;</span>, <span class="dt">level =</span> <span class="fl">0.95</span>)</code></pre></div>
<pre><code>##        fit      lwr      upr
## 1 195.9758 80.63344 311.3182</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># The same prediction</span>
reg$coefficients %*%<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">200</span>)</code></pre></div>
<pre><code>##          [,1]
## [1,] 195.9758</code></pre>
</div>
<div id="some-words-of-caution-with-r2" class="section level3">
<h3><span class="header-section-number">1.1.6</span> Some words of caution with <span class="math inline">\(R^2\)</span></h3>
<p><span class="math inline">\(R^2\)</span> does not measure the correctness of a linear model but the <strong>usefulness assuming the model is correct</strong>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Fixed design</span>
xf &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">l =</span> <span class="dv">50</span>)

<span class="co"># Errors with different variance</span>
<span class="kw">set.seed</span>(<span class="dv">123456</span>)
eps1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">50</span>, <span class="dt">sd =</span> <span class="fl">0.1</span>)
eps2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">50</span>, <span class="dt">sd =</span> <span class="dv">1</span>)

<span class="co"># Responses generated following a linear model</span>
y1 &lt;-<span class="st"> </span><span class="dv">1</span> +<span class="st"> </span><span class="dv">2</span> *<span class="st"> </span>xf +<span class="st"> </span>eps1
y2 &lt;-<span class="st"> </span><span class="dv">1</span> +<span class="st"> </span><span class="dv">2</span> *<span class="st"> </span>xf +<span class="st"> </span>eps2

<span class="co"># Fits</span>
reg1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y1 ~<span class="st"> </span>xf)
reg2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y2 ~<span class="st"> </span>xf)

<span class="co"># R^2 depends on the </span>
<span class="kw">summary</span>(reg1)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y1 ~ xf)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.26738 -0.08220 -0.00143  0.06930  0.19892 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  1.06719    0.02781   38.37   &lt;2e-16 ***
## xf           1.88910    0.04793   39.42   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.09981 on 48 degrees of freedom
## Multiple R-squared:   0.97,  Adjusted R-squared:  0.9694 
## F-statistic:  1554 on 1 and 48 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(reg2)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y2 ~ xf)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.27986 -0.59235  0.03505  0.57115  1.89983 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   0.5830     0.2595   2.247   0.0293 *  
## xf            2.6665     0.4472   5.963 2.86e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.9313 on 48 degrees of freedom
## Multiple R-squared:  0.4255, Adjusted R-squared:  0.4136 
## F-statistic: 35.55 on 1 and 48 DF,  p-value: 2.858e-07</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Plot</span>
<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))
<span class="kw">plot</span>(y1 ~<span class="st"> </span>xf, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(-<span class="dv">1</span>, <span class="dv">5</span>))
<span class="kw">abline</span>(<span class="dt">a =</span> <span class="dv">1</span>, <span class="dt">b =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="dv">2</span>)
<span class="kw">abline</span>(<span class="dt">a =</span> reg1$coefficients[<span class="dv">1</span>], <span class="dt">b =</span> reg1$coefficients[<span class="dv">2</span>], <span class="dt">col =</span> <span class="dv">3</span>)
<span class="kw">plot</span>(y2 ~<span class="st"> </span>xf, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(-<span class="dv">1</span>, <span class="dv">5</span>))
<span class="kw">abline</span>(<span class="dt">a =</span> <span class="dv">1</span>, <span class="dt">b =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="dv">2</span>)
<span class="kw">abline</span>(<span class="dt">a =</span> reg2$coefficients[<span class="dv">1</span>], <span class="dt">b =</span> reg2$coefficients[<span class="dv">2</span>], <span class="dt">col =</span> <span class="dv">3</span>)</code></pre></div>
<p><img src="SSS2-UC3M_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>A large <span class="math inline">\(R^2\)</span> means <em>nothing</em> if the <strong>assumptions of the model do not hold</strong>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create data that: </span>
<span class="co"># 1) does NOT follow a linear model</span>
<span class="co"># 2) the error is heteroskedastic</span>
xf &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">0.15</span>, <span class="dv">1</span>, <span class="dt">l =</span> <span class="dv">100</span>)
y3 &lt;-<span class="st"> </span><span class="fl">0.2</span> *<span class="st"> </span><span class="kw">sin</span>(<span class="dv">2</span> *<span class="st"> </span>pi *<span class="st"> </span>xf) +<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">100</span>, <span class="dt">sd =</span> <span class="fl">0.1</span> *<span class="st"> </span>xf^<span class="dv">2</span>)

<span class="co"># Great R^2!?</span>
reg3 &lt;-<span class="st"> </span><span class="kw">lm</span>(y3 ~<span class="st"> </span>xf)
<span class="kw">summary</span>(reg3)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y3 ~ xf)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.231885 -0.070384  0.006934  0.056374  0.218962 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.26718    0.02343   11.40   &lt;2e-16 ***
## xf          -0.49051    0.03742  -13.11   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.09274 on 98 degrees of freedom
## Multiple R-squared:  0.6368, Adjusted R-squared:  0.6331 
## F-statistic: 171.8 on 1 and 98 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># But predicting is obviously problematic</span>
<span class="kw">plot</span>(y3 ~<span class="st"> </span>xf, <span class="dt">pch =</span> <span class="dv">16</span>)
<span class="kw">lines</span>(<span class="fl">0.2</span> *<span class="st"> </span><span class="kw">sin</span>(<span class="dv">2</span> *<span class="st"> </span>pi *<span class="st"> </span>xf) ~<span class="st"> </span>xf, <span class="dt">col =</span> <span class="dv">2</span>)
<span class="kw">abline</span>(reg3, <span class="dt">col =</span> <span class="dv">3</span>)</code></pre></div>
<p><img src="SSS2-UC3M_files/figure-html/unnamed-chunk-9-1.png" width="672" /> Simple linear regression</p>
<p><span class="math display">\[Y_i=a+bX_i+\varepsilon,\quad i=1,\ldots,n.\]</span></p>
</div>
</div>
<div id="estimation-of-model-parameters-least-squares-inference-for-model-parameters-forecasting." class="section level2">
<h2><span class="header-section-number">1.2</span> Estimation of model parameters; least squares; inference for model parameters; forecasting.</h2>
</div>
<div id="assessing-model-fit-anova-model-validation-model-diagnostics-handling-nonlinear-relationships." class="section level2">
<h2><span class="header-section-number">1.3</span> Assessing model fit; ANOVA; model validation; model diagnostics; handling nonlinear relationships.</h2>
<p>You can label chapter and section titles using <code>{#label}</code> after them, e.g., we can reference Chapter <a href="#intro"><strong>??</strong></a>. If you do not manually label them, there will be automatic labels anyway, e.g., Chapter <a href="#methods"><strong>??</strong></a>.</p>
<p>Figures and tables with captions will be placed in <code>figure</code> and <code>table</code> environments, respectively.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, .<span class="dv">1</span>, .<span class="dv">1</span>))
<span class="kw">plot</span>(pressure, <span class="dt">type =</span> <span class="st">&#39;b&#39;</span>, <span class="dt">pch =</span> <span class="dv">19</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:nice-fig"></span>
<img src="SSS2-UC3M_files/figure-html/nice-fig-1.png" alt="Here is a nice figure!" width="80%" />
<p class="caption">
Figure 1.1: Here is a nice figure!
</p>
</div>
<p>Reference a figure by its code chunk label with the <code>fig:</code> prefix, e.g., see Figure <a href="simp.html#fig:nice-fig">1.1</a>. Similarly, you can reference tables generated from <code>knitr::kable()</code>, e.g., see Table <a href="simp.html#tab:nice-tab">1.1</a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knitr::<span class="kw">kable</span>(
  <span class="kw">head</span>(iris, <span class="dv">20</span>), <span class="dt">caption =</span> <span class="st">&#39;Here is a nice table!&#39;</span>,
  <span class="dt">booktabs =</span> <span class="ot">TRUE</span>
)</code></pre></div>
<table>
<caption><span id="tab:nice-tab">Table 1.1: </span>Here is a nice table!</caption>
<thead>
<tr class="header">
<th align="right">Sepal.Length</th>
<th align="right">Sepal.Width</th>
<th align="right">Petal.Length</th>
<th align="right">Petal.Width</th>
<th align="left">Species</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">5.1</td>
<td align="right">3.5</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">4.9</td>
<td align="right">3.0</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">4.7</td>
<td align="right">3.2</td>
<td align="right">1.3</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">4.6</td>
<td align="right">3.1</td>
<td align="right">1.5</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">5.0</td>
<td align="right">3.6</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">5.4</td>
<td align="right">3.9</td>
<td align="right">1.7</td>
<td align="right">0.4</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">4.6</td>
<td align="right">3.4</td>
<td align="right">1.4</td>
<td align="right">0.3</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">5.0</td>
<td align="right">3.4</td>
<td align="right">1.5</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">4.4</td>
<td align="right">2.9</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">4.9</td>
<td align="right">3.1</td>
<td align="right">1.5</td>
<td align="right">0.1</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">5.4</td>
<td align="right">3.7</td>
<td align="right">1.5</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">4.8</td>
<td align="right">3.4</td>
<td align="right">1.6</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">4.8</td>
<td align="right">3.0</td>
<td align="right">1.4</td>
<td align="right">0.1</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">4.3</td>
<td align="right">3.0</td>
<td align="right">1.1</td>
<td align="right">0.1</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">5.8</td>
<td align="right">4.0</td>
<td align="right">1.2</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">5.7</td>
<td align="right">4.4</td>
<td align="right">1.5</td>
<td align="right">0.4</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">5.4</td>
<td align="right">3.9</td>
<td align="right">1.3</td>
<td align="right">0.4</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">5.1</td>
<td align="right">3.5</td>
<td align="right">1.4</td>
<td align="right">0.3</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">5.7</td>
<td align="right">3.8</td>
<td align="right">1.7</td>
<td align="right">0.3</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">5.1</td>
<td align="right">3.8</td>
<td align="right">1.5</td>
<td align="right">0.3</td>
<td align="left">setosa</td>
</tr>
</tbody>
</table>
<p>You can write citations, too. For example, we are using the <strong>bookdown</strong> package <span class="citation">(Xie <a href="#ref-R-bookdown">2016</a>)</span> in this sample book, which was built on top of R Markdown and <strong>knitr</strong> <span class="citation">(Xie <a href="#ref-xie2015">2015</a>)</span>.</p>
<p>This is a <em>sample</em> book written in <strong>Markdown</strong>. You can use anything that Pandoc’s Markdown supports, e.g., a math equation <span class="math inline">\(a^2 + b^2 = c^2\)</span>.</p>
<p>For now, you have to install the development versions of <strong>bookdown</strong> from Github:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools::<span class="kw">install_github</span>(<span class="st">&quot;rstudio/bookdown&quot;</span>)</code></pre></div>
<p>Remember each Rmd file contains one and only one chapter, and a chapter is defined by the first-level heading <code>#</code>.</p>
<p>To compile this example to PDF, you need to install XeLaTeX.</p>

<div id="refs" class="references">
<div>
<p>Xie, Yihui. 2015. <em>Dynamic Documents with R and Knitr</em>. 2nd ed. Boca Raton, Florida: Chapman; Hall/CRC. <a href="http://yihui.name/knitr/" class="uri">http://yihui.name/knitr/</a>.</p>
</div>
<div>
<p>———. 2016. <em>Bookdown: Authoring Books with R Markdown</em>. <a href="https://github.com/rstudio/bookdown" class="uri">https://github.com/rstudio/bookdown</a>.</p>
</div>
</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-R-bookdown">
<p>Xie, Yihui. 2016. <em>Bookdown: Authoring Books with R Markdown</em>. <a href="https://github.com/rstudio/bookdown" class="uri">https://github.com/rstudio/bookdown</a>.</p>
</div>
<div id="ref-xie2015">
<p>Xie, Yihui. 2015. <em>Dynamic Documents with R and Knitr</em>. 2nd ed. Boca Raton, Florida: Chapman; Hall/CRC. <a href="http://yihui.name/knitr/" class="uri">http://yihui.name/knitr/</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>


<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/egarpor/SSS2-UC3M/edit/master/01-simp-lin-reg.Rmd",
"text": "Edit"
},
"download": ["SSS2-UC3M.pdf", "SSS2-UC3M.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
